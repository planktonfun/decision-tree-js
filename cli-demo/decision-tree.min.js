var dt=function(){function n(a){var b=v,e=a.trainingSet,d=a.ignoredAttributes,c={};if(d)for(var f in d)c[d[f]]=!0;this.root=b({trainingSet:e,ignoredAttributes:c,categoryAttr:a.categoryAttr||"category",minItemsCount:a.minItemsCount||1,entropyThrehold:a.entropyThrehold||0.01,maxTreeDepth:a.maxTreeDepth||70})}function p(a,b){for(var e=a.trainingSet,d=[],c=0;c<b;c++)d[c]=[];for(c=e.length-1;0<=c;c--)d[c%b].push(e[c]);e=[];for(c=0;c<b;c++){a.trainingSet=d[c];var f=new n(a);e.push(f)}this.trees=e}function q(a,
b){for(var e={},d=a.length-1;0<=d;d--)e[a[d][b]]=0;for(d=a.length-1;0<=d;d--)e[a[d][b]]+=1;return e}function w(a,b){var e=q(a,b),d=0,c,f;for(f in e)c=e[f]/a.length,d+=-c*Math.log(c);return d}function x(a,b){var e=q(a,b),d=0,c,f;for(f in e)e[f]>d&&(d=e[f],c=f);return c}function v(a){a.trainingSet.length>=s&&(s=a.trainingSet.length);a.trainingSet.length/s<=y&&(y=a.trainingSet.length/s);console.log(Math.floor(100-100*y)+"%");var b=a.trainingSet,e=a.minItemsCount,d=a.categoryAttr,c=a.entropyThrehold,
f=a.maxTreeDepth,n=a.ignoredAttributes;if(0==f||b.length<=e)return{category:x(b,d)};e=w(b,d);if(e<=c)return{category:x(b,d)};for(var m={},c={gain:0},z=b.length-1;0<=z;z--){var p=b[z],k;for(k in p)if(k!=d&&!n[k]){var t=p[k];for(predicateName in C)if(-1!=F[typeof t].indexOf(predicateName)){var r=k+predicateName+t;if(!m[r]){m[r]=!0;var r=C[predicateName],g;g=b;for(var l=k,A=r,h=t,q=[],D=[],u=void 0,E=void 0,B=g.length-1;0<=B;B--)u=g[B],E=u[l],A(E,h)?q.push(u):D.push(u);g={match:q,notMatch:D};l=w(g.match,
d);A=w(g.notMatch,d);h=0;h+=l*g.match.length;h+=A*g.notMatch.length;h/=b.length;l=e-h;l>c.gain&&(c=g,c.predicateName=predicateName,c.predicate=r,c.attribute=k,c.pivot=t,c.gain=l)}}}}if(!c.gain)return{category:x(b,d)};a.maxTreeDepth=f-1;a.trainingSet=c.match;b=v(a);a.trainingSet=c.notMatch;a=v(a);return{attribute:c.attribute,predicate:c.predicate,predicateName:c.predicateName,pivot:c.pivot,match:b,notMatch:a,matchedCount:c.match.length,notMatchedCount:c.notMatch.length}}n.prototype.predict=function(a){a:{for(var b=
this.root,e,d,c;;){if(b.category){a=b.category;break a}e=b.attribute;e=a[e];d=b.predicate;c=b.pivot;b=d(e,c)?b.match:b.notMatch}a=void 0}return a};p.prototype.predict=function(a){var b=this.trees,e={},d;for(d in b){var c=b[d].predict(a);e[c]=e[c]?e[c]+1:1}return e};var F={string:["==","contains","reversed","equal word count","greater word count"],number:[">=","==","reversed"],"boolean":["!!","=="]},C={"greater word count":function(a,b){return a.split(" ").length>=b.split(" ").length},"equal word count":function(a,
b){return a.split(" ").length==b.split(" ").length},reversed:function(a,b){var e;e="";if(void 0==a)e="";else for(var d=0;d<a.length;d++)e=a[d]+=e;return e==b},contains:function(a,b){return a.includes(b)},"!!":function(a,b){return a==!b},">=":function(a,b){return a>=b},"==":function(a,b){return a==b}},s=0,y=1,m={};m.DecisionTree=n;m.RandomForest=p;return m}();exports.dt=dt;
